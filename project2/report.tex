\documentclass{article}
\usepackage[swedish]{babel}
\usepackage{booktabs, float, listings, mathtools, tabu}

\title{TANA21: Implementation sekantmetoden i Matlab}
\author{Emil Segerbäck \and Olav Övrebö}

\begin{document}
\maketitle
\newpage

\section{Inledning}
För att finna rötter till en funktion ($x : f(x) = 0$) finns det flera metoder man kan använda sig av. Sekantmetoden är en itterativ numerisk metod som tar fram godtyckligt bra apporximationer av rötter.

\section{Uppgift}
Sekantmetoden ska implementeras som en Matlab-funktion och analyseras för att avgöra dess konvergensordning.

\section{Teori}
Sekantmetoden används för att ta fram approximationer av rötter till en given funktion $f(x)$ med godtyckligt litet fel. Metoden uppnår detta genom att att approximera funktioner med en sekantlinje mellan två punkter antaget liggandes nära en faktisk rot, för att ta fram allt bättre approximationer, och sedan upprepas med denna bättre approximation som en av de två punkterna, till det att felet är tillräckligt litet.

Den skiljer sig således från Newton Raphsons metod, en annan vanlig iterativ approximeringsmetod, som istället använder tangentlinjer och således kräver att derivatan $f'$ är känd. Sekantmetoden undgår alltså detta krav genom att använda en sämre korrigering i varje iterationssteg. Då bägge metoder är iterativa och kan nå godtyckligt bra approximationer medför detta dock endast att sekantmetoden riskerar kräva fler iterationer för att nå ett resultat av jämförbar noggrannhet.

Specifikt gäller att sekantmetoden utgör en talserie givet en funktion $f$ och två startvärden $n_{0}, n_{1}$ (lämpligen placerade nära den önskade roten): 

$ n_{i} = n_{i-1} - \frac{n_{i-1} - n_{i-2}}{f(n_{i-1}) - f(n_{i-2})} \cdot f(n_{i-1}), i = 2, 3, ...$

Där $n_{i}$ är en allt bättre approximation för högre värden på $i$. För implementation av metoden införs sedan ett slutvilkor att $|n_{i} - n_{i-1}| < E$, för någon övre feltolerans $E$.

\section{Lösning}
För att analysera sekantmetoden implementerades den rekursivt i Matlab; koden för detta redovisas under Resultat och svar nedan. 

\section{Resultat och svar}
Den färdiga implementationen utgörs av följande Matlab-funktion.
\begin{lstlisting}
function [root] = mysol(func, x0, x1, accuracy)
    korr = (x1 - x0) * func(x1)/(func(x1) - func(x0));
    if abs(korr) > accuracy
        root = mysol(func, x1, x1-korr, accuracy);
    else
        root = x1 - korr;
    end
end
\end{lstlisting}

\subsection{Noggrannhet}
För att testa den skrivna funktionen testades den för att hitta ett antal rötter till funktionerna $\sin(x)$ och $ (x+2) x (x-3)$. Resultaten redovisas i Tabell~\ref{tester}. Som tabellen visar gav alla de testade funktionerna ett resultat inom de efterfrågade feltoleranserna.
\begin{table}[H]
  \centering
  \begin{tabu}{ l l l l X[0.5cm] X l X }
    Funktion & $x_0$ & $x_1$ & Tolerans & Förväntat resultat & Resultat $\approx$ & Erhållet fel $\leq$ \\
    \toprule
    $\sin(x)$ & 0.8 & 1 & 0.01 & 0 & $2.1544 \cdot 10^{-7}$ & $10^{-6}$ \\
    $\sin(x)$ & 4 & 3.8 & 0.01 & $\pi$ & 3.1416 & $10^{-9} $\\
    $ (x+2) x (x-3)$ & -1 & 1 & 0.1 & 0 & $2.8160 \cdot 10^{-4}$ & $10^{-3}$ \\
    $ (x+2) x (x-3)$ & 4 & 2 & 0.1 & 3 & 3 & $10^{-2}$ \\
    $ (x+2) x (x-3)$ & -10 & -5 & 0.1 & -2 & -2.0156 & $10^{-1}$ \\
  \end{tabu}
  \caption{ Resultat av testning av funktionen }\label{tester}
\end{table}

\subsection{Konvergensordning}

\section{Diskussion}
Som väntat konvergerar sekantmetoden långsamare än Newton-Raphsons metod. Mindre väntat var att vi erhöll konvergensordningen som varandes det gyllene snittet. Möjligen anknyter detta till metodens likhet med så kallad gyllene snitt-sökning, en itrerativ metod för approximation av lokala extremvärden. 

Tydligt var också att metoden var ytterst opålitlig; sekantmetoden falerar regelbundet för dåligt valda startpunkter, dubbelrötter, och funktioner i allmänhet där sekanten ger en dålig approximation kurvan. 

\end{document}
